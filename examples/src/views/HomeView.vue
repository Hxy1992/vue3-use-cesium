<template>
	<div class="content">
		<h1 id="vue3-use-cesium">vue3-use-cesium</h1>
		<p>åŸºäº Vue3ã€Typescripã€Cesium çš„ç»„ä»¶åº“ã€‚</p>
		<h3>åŠŸèƒ½ ğŸ“–</h3>
		<p>åŸºäº pnpm workspaceã€viteã€glupã€rollup è„šæ‰‹æ¶ï¼Œä¾èµ– Vue3ã€Cesium å¼€å‘çš„ CBB å…¬å…±åº“â€”â€”vue3-use-cesium
			æœ‰ä»¥ä¸‹ç‰¹ç‚¹/åŠŸèƒ½ï¼š</p>
		<ul>
			<li>å¯æ”¯æŒ Cesium åº“çš„æŒ‰éœ€åŠ è½½</li>
			<li>åŸºäº vue3 ä¼ é€ç»„ä»¶ï¼Œå®ç°å¤šé¡µé¢å¤ç”¨å•ä¸ª Cesium å®ä¾‹ï¼Œé˜²æ­¢é¢‘ç¹åˆ‡æ¢åœ°å›¾å¯¼è‡´çš„å¡é¡¿ï¼Œéé¦–æ¬¡åœ°å›¾æ— æ„ŸåŠ è½½</li>
			<li>æ”¯æŒå°è£… hookï¼Œä½¿ç”¨ç®€å•</li>
			<li>æ”¯æŒåœ°å½¢ã€äº‹ä»¶ç®¡ç†ã€å›¾å±‚ç®¡ç†ã€å›¾å±‚å¼¹çª—ç­‰</li>
			<li>æ”¯æŒåœ°å›¾å·¥å…·ï¼ˆä¸»é¡µã€åº•å›¾å›¾å±‚ã€æ”¾å¤§ç¼©å°ã€äºŒä¸‰ç»´åˆ‡æ¢ç­‰ï¼‰ã€åœ°å›¾çŠ¶æ€ä¿¡æ¯ï¼ˆé¼ æ ‡ä½ç½®ã€ç›¸æœºä¿¡æ¯ï¼‰</li>
			<li>æ”¯æŒæ ‡ç»˜åŠŸèƒ½ï¼Œç»˜åˆ¶ç‚¹çº¿é¢ã€è´´åœ°/è´´æ¨¡å‹ç»˜åˆ¶ç­‰ç­‰ï¼Œç»“æœå¯è¾“å‡º geojson</li>
			<li>æ”¯æŒæµ‹é‡åŠŸèƒ½ï¼Œåæ ‡æµ‹é‡(æ¤­çƒ/åœ°å½¢/æ¨¡å‹)ã€è·ç¦»æµ‹é‡(æ¤­çƒ/åœ°å½¢/æ¨¡å‹/è´´åœ°/è´´æ¨¡å‹) ã€é¢ç§¯æµ‹é‡(æ¤­çƒ/åœ°å½¢/æ¨¡å‹/è´´åœ°/è´´æ¨¡å‹) ã€é«˜åº¦å·®æµ‹é‡(åœ°å½¢/æ¨¡å‹) ã€ä¸‰è§’æµ‹é‡(åœ°å½¢/æ¨¡å‹)</li>
			<li>æ”¯æŒç‚¹èšåˆ</li>
			<li>æ”¯æŒåœºæ™¯ä¹¦ç­¾</li>
			<li>æ”¯æŒå¸¸ç”¨ Entityã€Primitive æè´¨ï¼Œå¦‚å…‰ç”µæ‰«æçƒã€é¢œè‰²æ‰«æçƒã€é›·è¾¾æ‰«æã€æ‰©æ•£åœ†ã€æ¸å˜å¢™ã€é—ªçƒçº¿ç­‰ç­‰</li>
			<li>æ”¯æŒçƒ­åŠ›å›¾</li>
		</ul>
		<p>å…³äº Cesium ç‰ˆæœ¬å…¼å®¹æ€§ï¼Œå·²åœ¨ 1.105ã€1.119 ç‰ˆæœ¬è¿›è¡ŒéªŒè¯ã€‚</p>
		<h3>å¿«é€Ÿå¼€å§‹ ğŸ“”</h3>
		<ul>
			<li>
				<strong>å®‰è£…</strong>
			</li>
		</ul>
		<pre>
	<code class="language-bash">yarn add vue3-use-cesium # npm i vue3-use-cesium --save
</code>
</pre>
		<ul>
			<li>
				<strong>ä½¿ç”¨</strong>
			</li>
		</ul>
		<ol>
			<li>å¼•å…¥ç»„ä»¶å’Œæ ·å¼</li>
		</ol>
		<p>åœ¨ App.vue ä¸­ä½¿ç”¨ç»„ä»¶ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
		<pre>
	<code class="language-vue">&lt;template&gt;
    &lt;router-view&gt;&lt;/router-view&gt;
    &lt;z-map-base /&gt;
&lt;/template&gt;
&lt;script setup lang=&quot;ts&quot;&gt;
import { ZMapBase } from &quot;vue3-use-cesium&quot;;
&lt;/script&gt;
</code>
</pre>
		<p>åœ¨ main.js å¼•å…¥æ ·å¼ï¼š</p>
		<pre>
	<code class="language-typescript">import &quot;vue3-use-cesium/style&quot;;
</code>
</pre>
		<ol start="2">
			<li>åœ¨è·¯ç”±æ‹¦æˆªä¸­åŠ è½½åˆå§‹åŒ–å¹¶åŠ è½½ Cesium.js</li>
		</ol>
		<pre>
	<code class="language-typescript">import { initMap } from &quot;vue3-use-cesium&quot;;
// è·¯ç”±æ‹¦æˆª
router.beforeEach(async (to, from, next) =&gt; {
    // ...

    // å¦‚æœé¡µé¢åŒ…å«åœ°å›¾åˆ™åŠ è½½Cesium.js
    if (to.meta.hasMap) {
        await initMap([`/CesiumV1.105/Cesium.js`, `/CesiumV1.105/Widgets/widgets.css`], {
            imagery: &quot;gd-img&quot;
        });
    }

    // ...
    next();
});
</code>
</pre>
		<ol start="3">
			<li>å®šä¹‰ hooksï¼ˆå¯é€‰ï¼‰</li>
		</ol>
		<pre>
	<code class="language-typescript">import { onBeforeUnmount, onMounted } from &quot;vue&quot;;
import { setToTarget, setVisible, clearMapElements, clearMapEvents, getViewer } from &quot;vue3-use-cesium&quot;;

/**
 * åŸºç¡€åœ°å›¾ä½¿ç”¨
 * @param selector divçš„id / body
 * @param mapCreated æˆåŠŸå›è°ƒ(è¿”å›Viewer)
 */
export const useBaseMap = (selector: string, mapCreated?: (viewer: any) =&gt; void) =&gt; {
    onMounted(() =&gt; {
        setToTarget(selector);
        setVisible(true);
        if (mapCreated) {
            mapCreated(getViewer());
        }
    });
    onBeforeUnmount(() =&gt; {
        clearMapElements();
        clearMapEvents();
        setVisible(false);
        setToTarget(&quot;body&quot;);
    });
};
</code>
</pre>
		<ol start="4">
			<li>é¡µé¢ä½¿ç”¨</li>
		</ol>
		<pre>
	<code class="language-vue">&lt;template&gt;
    &lt;!-- åªæœ‰ä¸€ä¸ªé¡¶å±‚div --&gt;
    &lt;div class=&quot;bbox&quot;&gt;
        &lt;!-- åœ°å›¾å®¹å™¨ä¸èƒ½æ˜¯é¡¶å±‚div --&gt;
        &lt;div id=&quot;my-map&quot;&gt;
            &lt;!-- åœ°å›¾å¼¹çª—... --&gt;
        &lt;/div&gt;
        &lt;!-- åœ°å›¾é¢æ¿ç­‰... --&gt;
    &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import { useBaseMap } from &quot;@/hooks/useCesium&quot;;

// åœ°å›¾åˆå§‹åŒ–
useBaseMap(&quot;#my-map&quot;, viewer =&gt; {
    console.log(viewer);
});
&lt;/script&gt;
</code>
</pre>

	</div>
</template>

<style scoped>
.content {
	height: 100%;
	padding: 50px 150px;
	overflow: auto;
}

.content pre {
	padding: 10px;
	margin: 0;
	color: #23263b;
	word-break: break-all;
	word-wrap: break-word;
	white-space: pre;
	counter-reset: itemcounter;
	background: rgb(245 245 250);
	border: 0;
	border-radius: 0 0 4px 4px;
}
</style>
